<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Multas</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
        }
        .header {
            background-color: #0044cc;
            color: white;
            padding: 10px;
            text-align: center;
            position: relative;
        }
        .goto-clipboard {
            position: absolute;
            right: 10px;
            top: 10px;
            background-color: white;
            color: #0044cc;
            border: 1px solid #0044cc;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        .goto-clipboard:hover {
            background-color: #f0f0f0;
        }
        .search-container {
            display: flex;
            justify-content: center;
            margin: 20px;
        }
        .search-container input {
            width: 300px;
            padding: 10px;
            font-size: 16px;
        }
        .results {
            margin: 20px;
            padding: 20px;
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .result-item {
            margin-bottom: 10px;
            cursor: pointer;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
        .result-item:hover {
            background-color: #f0f0f0;
        }
        .result-item.selected {
            background-color: #d1e7dd;
            border-color: #b5d5c9;
        }
        .clipboard {
            margin: 20px;
            padding: 20px;
            background: #e9ffe9;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .clipboard h2 {
            margin-top: 0;
        }
        .clipboard-item {
            margin-bottom: 10px;
        }
        .total {
            font-weight: bold;
            margin-top: 20px;
            font-size: 1.2em;
        }
    </style>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const multas = Array.from({ length: 1000 }, (_, i) => ({
                articulo: `Art. ${i + 1}`,
                descripcion: `Descripción de la infracción ${i + 1}`,
                multa: Math.floor(Math.random() * 1000) + 50
            }));

            const PAGE_SIZE = 50;

            let portapapeles = [];
            let currentPage = 0;
            let currentQuery = "";

            const searchInput = document.getElementById("search-input");
            const resultsContainer = document.getElementById("results");
            const clipboardContainer = document.getElementById("clipboard");
            const totalContainer = document.getElementById("total");

            function debounce(func, delay) {
                let timeout;
                return (...args) => {
                    clearTimeout(timeout);
                    timeout = setTimeout(() => func(...args), delay);
                };
            }

            function mostrarMultas(pagina = 0, query = "") {
                resultsContainer.innerHTML = "";

                const filteredMultas = multas.filter(multa =>
                    multa.articulo.toLowerCase().includes(query) ||
                    multa.descripcion.toLowerCase().includes(query)
                );

                const start = pagina * PAGE_SIZE;
                const end = start + PAGE_SIZE;
                const multasParaMostrar = filteredMultas.slice(start, end);

                if (multasParaMostrar.length === 0) {
                    resultsContainer.textContent = "No se encontraron resultados.";
                } else {
                    multasParaMostrar.forEach(multa => {
                        const div = document.createElement("div");
                        div.className = "result-item";
                        div.textContent = `${multa.articulo} - ${multa.descripcion}: ${multa.multa} €`;
                        if (portapapeles.find(item => item.articulo === multa.articulo)) {
                            div.classList.add("selected");
                        }
                        div.onclick = () => toggleMultaEnPortapapeles(multa, div);
                        resultsContainer.appendChild(div);
                    });

                    if (end < filteredMultas.length) {
                        const loadMore = document.createElement("button");
                        loadMore.textContent = "Cargar más";
                        loadMore.style.display = "block";
                        loadMore.style.margin = "20px auto";
                        loadMore.style.padding = "10px";
                        loadMore.onclick = () => {
                            mostrarMultas(pagina + 1, query);
                        };
                        resultsContainer.appendChild(loadMore);
                    }
                }
            }

            function toggleMultaEnPortapapeles(multa, element) {
                const index = portapapeles.findIndex(item => item.articulo === multa.articulo);
                if (index !== -1) {
                    portapapeles.splice(index, 1);
                    element.classList.remove("selected");
                } else {
                    portapapeles.push(multa);
                    element.classList.add("selected");
                }
                actualizarPortapapeles();
            }

            function actualizarPortapapeles() {
                clipboardContainer.innerHTML = "<h2>Portapapeles</h2>";

                if (portapapeles.length === 0) {
                    clipboardContainer.innerHTML += "<p>No hay multas en el portapapeles.</p>";
                } else {
                    portapapeles.forEach(multa => {
                        const div = document.createElement("div");
                        div.className = "clipboard-item";
                        div.textContent = `${multa.articulo} - ${multa.descripcion}: ${multa.multa} €`;
                        clipboardContainer.appendChild(div);
                    });
                }

                const total = portapapeles.reduce((acc, multa) => acc + multa.multa, 0);
                totalContainer.textContent = `Total: ${total} €`;
            }

            const gotoClipboardButton = document.getElementById("goto-clipboard");
            gotoClipboardButton.addEventListener("click", () => {
                document.getElementById("clipboard").scrollIntoView({ behavior: "smooth" });
            });

            searchInput.addEventListener("input", debounce(() => {
                currentQuery = searchInput.value.toLowerCase();
                currentPage = 0;
                mostrarMultas(currentPage, currentQuery);
            }, 300));

            mostrarMultas();
        });
    </script>
</head>
<body>
    <div class="header">
        <h1>Calculadora de Multas</h1>
        <button id="goto-clipboard" class="goto-clipboard">Ir al Portapapeles</button>
    </div>

    <div class="search-container">
        <input type="text" id="search-input" placeholder="Buscar...">
    </div>

    <div id="results" class="results">
        <!-- Resultados aparecerán aquí -->
    </div>

    <div id="clipboard" class="clipboard">
        <h2>Portapapeles</h2>
        <p>No hay multas en el portapapeles.</p>
        <div id="total" class="total">Total: 0 €</div>
    </div>
</body>
</html>
